<!DOCTYPE html><html lang="ja"><head><meta charset="utf-8">
<title>Secure Contexts （日本語訳）</title>

<link rel="stylesheet" href="common.css" type="text/css" />
<link rel="stylesheet" href="common-w3c.css" type="text/css" />

<style>
@namespace svg url(http://www.w3.org/2000/svg);

svg|*.secure {
  fill: #8F8;
}

svg|*.non-secure {
  fill: #F88;
  stroke-dasharray: 5,5;
}

svg|rect, svg|circle {
  stroke-width: 2;
  stroke: black;
  fill-opacity: 0.75;
}
svg|text {
  font-family: monospace;
}
svg|text.rejection {
  fill: #F00;
  font-weight: 700;
  font-size: 2em;
}
svg|path {
  stroke-width: 2px;
  stroke: #666;
  fill-opacity: 0;
  stroke-dasharray: 5px, 5px;
}
</style>


<!--%style -->
<style>

.scheme {
	color: #006633;
}

samp {
	white-space: nowrap;
	background: #F0F0F0;
	margin-left: 0.5em;
	margin-right: 0.5em;
}

i {
	color: purple;
}

</style>

<script src="common0.js" ></script>
<script src="common1.js" async></script>

<script>

Util.ready = function(){
	const source_data = {
		collectParts: Util.collectParts,
		toc_main: 'MAIN0',
		generate: expand
	};
	Util.switchWordsInit(source_data);
}

function expand(){
	const class_map = this.class_map;
	const tag_map = this.tag_map;
	const link_map = this.link_map;

	return this.html.replace(
		/%[\w\-~一-鿆]+|`(.*?)([$@^])(\w*)/g,
		create_html
	);

	function create_html(match, key, indicator, klass){

if(!indicator) {//%
	return `<var>${match.slice(1)}</var>`;
}

var text = key;
var href = '';

switch(klass){
case 'r': // 文献
	text = `[${key}]`;
	href = `#biblio-${key.toLowerCase()}`;
	break;
case 'sc': //url scheme
	text = key + ':';
	break;
case 'l': //literal
	return `"<code class="literal">${key}</code>"`;
	break;
case 'en': // english words
	return `<span lang="en-x-a0">${key}</span>`;
	break;
case 'dgm':
	return `<a id="_dgm-${key}">＊</a>`;
	break;
}

let tag = tag_map[klass];
if(tag) {
	let classname = class_map[klass];
	classname = classname ? ` class="${classname}"` : '';
	text = `<${tag}${classname}>${text}</${tag}>`;
}

if(indicator !== '^'){
	href = link_map[ klass ? `${klass}.${key}` : key ] || href;
	if(!href){
		console.log(match); // check error
		return match;
	}

	switch(indicator){
	case '$':
		text = `<a href="${href}">${text}</a>`;
		break;
	case '@':
		text = `<dfn id="${href.slice(1)}">${text}</dfn>`;
		break;
	}
}

return text;

	}
}
</script>


<script type="text/plain" id="_source_data">


●●options

spec_date:2019-03-15
trans_update:2019-03-22
source_checked:171018
page_state_key:WEBAPPSEC
original_url:https://w3c.github.io/webappsec-secure-contexts/
spec_status:ED
ref_id_prefix:biblio-
ref_id_lowercase:true
conformance:w3c
copyright:2019,use
trans_1st_pub:2016-06-04


●●class_map
e:element
a:attr
sc:scheme
et:event-type
v:value
E:error

●●tag_map
e:code
a:code
et:code
I:code
m:code
sc:code
E:code
v:code
c:code
s:samp
i:i

●●words_table


	●仕様（動詞）
制約-:restrict:~
制約:restriction:~
	制約-法:restricting
制限-:limit:~
含意:implications:~
定義-:define:~
定義:definition:~
公告-:announce:~
奨励-:encourage:~
実行-:execute:~
	executing:~
実行時:runtime:~
実装-:implement:~
実装:implementation:~
実装者:implementer:~
実験:experiment:~
導入-:introduce:~
意図:intent:~
意向:intention:~
意味され:mean され:意図され
懸念-:concern:~
推奨-:recommend:~
推奨:recommendation:~
供-:provide:~
提供-:offer:~
欠く:lack する:~
決定-:determine:~
無視-:ignore:~
確保-:ensure:~
示唆-:suggest:~
示唆:suggestion:~
組入れる:incorporate する:組み入れる
統合:intergration:~
考慮-:consider:~
考慮点:considerations:~
見なさ:consider さ:~
見なす:consider する:~
見なし:consider し:~
見做-:assume:~
見做さ:assume し:~
	assumption
説明-:explain:~
適切:appropriate:~
適合-:conform:~
適合的:conformant:~
関与-:participate:~
警告-:warn:~
拡張-:extend:~
拡張:extension:~
開発-:develop:~
開発:development:~
開発者:developer:~
要件:requirements:~
要求-:require:~
要約-:summarize:~
不能化-:disable:~
論じら:discuss さ:~
移行-:migrate:~
従事:engage:~
概説する:outline する:要旨を述べる
概説した:outline した:要旨を述べた
表明-:assert:~
挙動:behavior:ふるまい
固守-:adhere:~
落とさ:drop さ:~
同意:agreement:~
同意-:agree:~
抑制-:reduce:~
	抑制するのみ:strict reduction

	注記-:note:~
	注記:Note:~

	●仕様
critical:
UA:
API:
web:
app:application:::アプリ
応用:application:~
team::::チーム
framework::::フレームワーク
feedback::::フィードバック
support::::サポート
model::::モデル
platform::::プラットフォーム
vendor::::ベンダ
browser::::ブラウザ
version::::バージョン
一般:general:~
一貫して:consistent に:~
上書き:override:~
	:substep:~
不完全:incomplete:~
主体:party:~
仕事:work:~
仕方:way:~
仕様:spec:~
仕様化-:specify:~
仕組み:mechanism:~
伝統的:traditional:~
作者:author:~
策定者:author:~
編集者:editor:~
便宜性:facilities:~
利用者:user:~:::ユーザ
前提条件:precondition:~
	加えて:additionally
原則的:principle:~
厳格:strict:~
取扱う:handle する:取り扱う
可用:available:~
アリ:possible:可能
困難:difficult:~
公共:public:~
影響0:impact:影響
方式:manner:~
既存の:existing:~
旧来の:legacy な:~
早急:quick:~
早期の:early:~
明らか:obvious:~
明白:clear:~
最小限:minimum:~
最近の:recent:~
有用:useful:~
概念:concept:~
標準:standard:~
歴史的:historical:~
段差舗装:speed-bump:~
汎用の:generic な:~
特定の:specific な:~
特有の:-specific な:~
特能:feature::~
状況:situations:~
状況下:circumstances:~
独特の:distinct:~
網羅的:non-exhaustive:~
規範的:normative:~
変更点:changes:~
通常は:normal には:~
適度:reasonable:~
適理な:reasonable な:理に適う
重要:important:~
間接的:indirect:~
非推奨に:deprecate:~
非推奨:deprecation:~
	要約:abstract:~
観点:perspective:~
計画:plan:~
記法:notation:~
	述-:describe:~
試験用:staging:~
詳細:details:~
	謝辞:acknowledgement:~
感触:feel:~
感覚:sense:~
native::::ネイティブ
特別:special:~
	特別な事例に:special-casing:~
環境:environment:~
不確かさ:uncertainty:~
用法:usage:~
広範:wide:~
協同する:cooperative な:~
即時:immediate:~
単純:simple:~
手動:manual:~
容易:easy:~
理解:understanding:~
簡便:convenient:~
資質:nature:~
具体:concrete:~
親切さ:friendlyness:~
伝える:inform する:~
要請:request:~
関心:interest:~
課題:issue:~
主流:majority:~
現今:today:~
規則:rule:~
関連する:relevant な:~
効果:effect:~
	何ら効果がなかった。completely ineffective

	容易に:easily
	序論:introduction:~
	答え:answer:~
	同様に:likewise:~
	倣う:align する
	interesting
	後述の:follow
	得-:obtain
	所から始める:approach
	織り込む:take account:
	善悪は別に，:better or worse
	間違いなく:certainly
	相応に:fairly
	移行過程:path forward
	作り込み:niceties
	短い答え:short answer
	どうにかして:somehow
	ますます:increasingly
	見え難い部分を次第に拡げていく:increasingly esoteric
	されるべき:ought
	例:example
	格好の／良い:good
	かかわらず:no matter
	〜に基づく:based
	依然として:still
	利用-:use
	則って:accordingly
	十分:enough
	さしあたり:meantime
	常に:always
	必要-:need
	必要とされ:necessary
	忘れる:forget
	書くこと:writing
	特に挙げられる:particularly-noteworthy
	関して:regarding
	類似する:similar
	少しばかり:little more than
	扱う:treat
	~~実際に:do
	capable
	clear
	Leading up to the flag day
	please
	in order to
	informative
	fall
	類するfalling
	特に，:great
	meet
	met
	任意の:any
	取りかかる:work on
	~~評価:metrics
	~~規範:upstream

	●保安
privacy::::プライバシー
risk::::リスク
	esoteric
	exfiltration
私的:private::~::プライベート
敏感:sensitive::~::センシティブ
敏感な:sensitive::~::センシティブな
保安:security::~:セキュリティ
保安的:secure::~:セキュア
非保安的:non-secure::~:非セキュア

攻撃者:attacker::~
敵:adversaries:~
	個人を特定する:personally-identifying:~

是認-:grant::~
否認-:deny::~
	denied
善意:benevolent:~
堅牢:robust::~
完全性:integrity::~

保証:guarantee::~
保証-:guarantee::~
弱体化-:compromise::~
持続化-:persist::~
持続的:persistent::~
保護-:protect::~
保護:protection::~
操作-:manipulate:~
改変-:modify::~
改変:modification::~
暗号化-:encrypt::~
	encrypted:~
未認証の:unauthenticated:~
機器:device:~
機密性:confidentiality::~
機密的:confidential::~
機能性:functionality:~
混在:mixed::~
検出:detection::~
検査-:check::~::チェック
検査:check::~::チェック
	検査-法:checking
標的に:target::~
濫用-:abuse:~
許可:permission::~::パーミッション
許容-:allow:~
	許容しない:disallow
認証:authentication::~
認証-:authenticate::~
	認証-済み:authenticated
認証性:authenticity::~
認識-:recognize:~
再生-:replay::~
読取る:read する::読み取る
迂回-:bypass::~
迂回:bypass::~
防御-:defend::~
防止-:prevent::~
防護-:guard::~
阻止-:block::~::ブロック
隔離-:isolate::~
隔離:isolation::~

無法:nefarious:~
危険:dangerous:~
受動的:passive::~::パッシブ
能動的:active::~::アクティブ
能:ability:~
能力:capability::~
脅威:threat::~
脆弱性:vulnerabilities::~
行為者:actor::~
強力:powerful::~
監視:monitoring::~
監視0:surveillance:監視
可視:visible:~


	●保安文脈
frame::::フレーム
sandbox::::サンドボックス
	sandboxed
	~sandbox法:sandboxing
window::::ウィンドウ
package::::パッケージ
	packaged

添付-:attach::~
worker::::
専用:dedicated::~
共用:shared::~
service:
top-level::::トップレベル
信用-:trust::~
信用:trust::~
	信用-済み:trusted
	信用に価する:trustworthy:~
	信用に価しない:untrustworthy:~
	信用に価しない:non-trustworthy:~
	信用に価し得る:potentially trustworthy:~
	価する
	価しない

文脈:context::~
閲覧文脈:browsing context::~
閲覧:browsing::~
埋込まれ:embed され::埋め込まれ
担当の:responsible な::~
作動中の:active な::~::アクティブな
環境設定-:configure::~
大域:global::~::グローバル
所有者:owner:~
資格証:credential::資格証明情報::クレデンシャル
生成元:origin::~::オリジン
同一-:same-::~
成分組:tuple::~::タプル
不透明な:opaque::~
継承-:inherit::~
開いた:open した::~
開かれ:open された::~
堅固:solid:~
先天的:a priori:~
指令:directive::~::ディレクティブ


	●network
HTTPS:
client::::クライアント
file::::ファイル
channel::::チャネル
cookie::::
disk::::ディスク
loopback::::ループバック
address::::アドレス
message::::メッセージ
network::::ネットワーク
server::::サーバ
session::::セッション
site::::サイト
localhost:
流通:traffic::~
transport::::トランスポート
scheme::::スキーム
host::::ホスト
port::::ポート
domain::::ドメイン
flow::::フロー
解決:resolution::~
解決-:resolve::~
解決器:resolver::~
送信-:send:~
送達-:deliver::~
運ぶ:carry する:~
追跡-:track::~
配備-:deploy::~
接続-:connect::~
通過-:transit::~
通信-:communicate::~

局所:local::~::ローカル
層:layer::~::レイヤ
資源:resource::~:リソース
無線:wireless:~

	●IDL／型／構造
blob:
index:
member::::メンバ
data::::データ
boolean:
list::::リスト
obj:object:::オブジェクト
interface::::インタフェース
class::::クラス
属性:attribute::~
拡張属性:extended attribute::~
構築子:constructor::~::コンストラクタ
取得子:getter::~
名:name::~
名前:name::~
型:type::~
入子に:nest::入れ子に
親:parent::~
先祖:ancestor::~
	先祖による:ancestral
設定群:settings::~
設定-:set::~
	設定し直:reset
公開-:expose:~
追加-:add:~
除去-:remove::~
作成-:create::~
作成元:creator::~
作成時の:creation::~
識別-:identify::~
識別子:identifier::~
挿入-:insert::~
結付けら:associate さ:結び付けら
関数:function::~
集合:set::~
内容:content::~
文書:document::~


	●処理
algo:algorithm:::アルゴリズム
call:
callback:
error::::エラー
	~errorにする:err
event::::イベント
構文解析-:parse::~::パース
flag::::フラグ
演算:operation:~
投出:throw::~
呼出す:invoke する:呼び出す
成功-:succeed::~
	失敗
優先-:prioritize:~
指図-:direct::~
却下-:reject::~
可能化-:enable:~
走らせ:run し:~
走らす:run する:~
一時的:temporary:~
例外:exception::~
状態:state::~
観測-:observe::~
登録-:register::~
試みた:attempt した:~
入力:input::~
合致-:match::~
段:step:~

	●未分類
	GPS
	Internet
	Netflix
	Promise:
	ISP:Internet Service Provider:
	Service Worker
	Shared Worker
	Dedicated Worker
UI:
URL:
access::::アクセス
code::::コード
console::::コンソール
critical:

camera::::カメラ
hardware::::ハードウェア
microphone::::マイクロフォン
sensor::::センサ
金銭的利益:financial gain:~
level::::レベル
link::::リンク
lock::::ロック
shim:
text::::テキスト
view::::ビュー
HTML:
	-:component:~
巡回-:walk through:~
	相似-:analog:~
粗く:coarsen:~
精度:accuracy:~
除外-:exclude::~
内側:inside:~
加速度計:accelerometer:~
完全0:perfect:完全
完全:complete:~
実体:entities:~
情報:information:~
等価:equivalent:~
築いて:build して:~
築いた:build した:~
遮る:obscure する:~
アテガって:assign して:あてがって

	locking
	long::::
	期日:schedule::~::スケジュール
	日付:date
	operator
	地番~levelでなく府県~level:city-level data rather than high-accuracy
	対外支払い法:payment instruments
	simply
	html
	Chrome
	high-accuracy
	across:
	entire
	frame内の:framed
	go
	hand
	-:help
	lay
	住まう:live
	made
	mailing
	making
	meant
	most
	neither
	past
	期間後:period
	個々の利用者／組織／団体／あらゆる人々:individual users, organizations or even entire populations
	potential
	~~存在:presence
	put
	remain
	time
	vendor-specific
	そっくり機能停止:stops working altogether
	~~実在:indeed 〜 present
	おそらく:perhaps
	ないがしろに:subvert
	べき:should
	pose
	所与の:given
	与-:give
	介:via
	断ち切れる:broken
	含-:include
	含めて:including
	始-:begin
	抗して:against
	数:number
	現れ:appear
	等しく:equally
	見よ:see
	見る:look at
	返す:return
	遅くする:slow down
	ことにする／:choose
	それ自体:on its own merits
	その日が来る前に:Leading up to the flag day,
	道連れ:altogether

	●指示語
新たな:new:~
現在は:current では:~
現在の:current:~
	結果:result
	両者:both
	側:side
	多数:large number
	大きく:largely
	節:section
	こと:thing
	この:this
	これらの:these
	しかしながら，:however
	したがって:therefore
	すべての:all
	その:that
	そのような:such
	その他:others
	その逆:vice-versa
	それら:they
	それらの:their
	それらの:those
	それらを:them
	それら自身:themselves
	まったく
	一つ:one
	一定の／ある種の:certain
	上:above
	下:below
	他の:other
	他の場合:otherwise
	他では:otherwise〜
	何か:something
	前:before
	同じ:same
	多い:often
	多くの:many
	最初の:first
	異なる:different
	等々:etc
	自身:itself
	複数の:multiple


●●original_id_map


●●words_table1


●●link_map



	●IDL
SecureContext:~WEBIDL#SecureContext

I.Document:~DOM4#interface-document
	~HTMLdom#the-document-object
I.Window:~WINDOW#window
I.WorkerGlobalScope:~WORKERS#workerglobalscope
I.BroadcastChannel:~HTMLcomms#broadcastchannel
I.WindowOrWorkerGlobalScope:~HTMLGAPI#windoworworkerglobalscope

I.SharedWorker:~WORKERS#sharedworker
m.getCurrentPosition():http://www.w3.org/TR/geolocation-API/#get-current-position
m.isSecureContext:#dom-windoworworkerglobalscope-issecurecontext
m.sessionStorage:~WEBSTORAGE#the-sessionstorage-attribute
m.localStorage:~WEBSTORAGE#the-localstorage-attribute
m.watchPosition():http://www.w3.org/TR/geolocation-API/#watch-position

e.iframe:~HEembed#the-iframe-element

et.storage:~WEBSTORAGE#the-storage-event

	secure contexts:#secure-context
	~top-level文書 節:#examples-top-level
保安的~文脈を与え:#environment-settings-object-contextually-secure
環境~設定群~objは保安的~文脈を与えるか？:#is-settings-object-contextually-secure
生成元は信用に価し得るか？:#is-origin-trustworthy
~URLは信用に価し得るか？:#is-url-trustworthy
	§:#monkey-patching-sandbox-flags
	§:#threat-models
	§:#ancestors
	§:#isolation
	§:#implementation-considerations
	§:#packaged-applications
	§:#development-environments
	§:#new
v.noopener:~HTMLlinks#link-type-noopener
v.allow-secure-context:#attr-valuedef-iframe-sandbox-allow-secure-context

閲覧文脈~sandbox化( 保安的 )~flag:#sandboxed-secure-browsing-context-flag

保安的~文脈:#secure-contexts
非保安的~文脈:#non-secure-contexts
非保安的:#non-secure-contexts
信用に価し得る生成元:#potentially-trustworthy-origin
信用に価し得る~URL:#potentially-trustworthy-url

~URL:~URL1#url
url.~scheme:~URL1#concept-url-scheme
	url.~host:~URL1#concept-url-host
url.生成元:~URL1#concept-url-origin

所有者~集合:~WORKERS#concept-WorkerGlobalScope-owner-set

閲覧文脈:~BROWSERS#browsing-context
親~閲覧文脈:~BROWSERS#parent-browsing-context
先祖~閲覧文脈:~BROWSERS#ancestor-browsing-context
~top-level閲覧文脈:~BROWSERS#top-level-browsing-context
作動中の文書:~BROWSERS#active-document

生成元:~ORIGIN#concept-origin
	https://www.w3.org/TR/html#concept-cross-origin
不透明な生成元:~ORIGIN#concept-origin-opaque
成分組~生成元:~ORIGIN#concept-origin-tuple
~scheme:~ORIGIN#concept-origin-scheme
~host:~ORIGIN#concept-origin-host
~domain:~ORIGIN#concept-origin-domain
~port:~ORIGIN#concept-origin-port
作動中の~sandbox法~flag集合:~ORIGIN#active-sandboxing-flag-set
~sandbox法~指令を構文解析する:~ORIGIN#parse-a-sandboxing-directive
閲覧文脈~sandbox化( 生成元 )~flag:~ORIGIN#sandboxed-origin-browsing-context-flag

現在の設定群~obj:~WAPI#current-settings-object
大域~obj:~WAPI#global-object
環境~設定群~obj:~WAPI#environment-settings-object
関連する設定群~obj:~WAPI#relevant-settings-object
enV.~HTTPS状態:~WAPI#https-state
enV.作成時の~URL:~WAPI#concept-environment-creation-url
enV.大域~obj:~WAPI#concept-settings-object-global
enV.担当の文書:~WAPI#responsible-document
enV.生成元:~WAPI#concept-settings-object-origin

先天的に認証-済み~URL:~MIXED-CONTENT#a-priori-authenticated-url
公開され:~WEBIDL#dfn-exposed

x.改変する:https://www.w3.org/2015/Process-20150901/#rec-modify
仕様を改変-:https://www.w3.org/2015/Process-20150901/#rec-modify
	modified:https://www.w3.org/2015/Process-20150901/#rec-modify
	modifying the specification:https://www.w3.org/2015/Process-20150901/#rec-modify

専用~worker:~WORKERS#infrastructure-2
共用~worker:~WORKERS#infrastructure-2
	

●●ref_normative

[DOM]
    Anne van Kesteren. DOM Standard. Living Standard. URL: https://dom.spec.whatwg.org/ 
[HTML]
    Anne van Kesteren; et al. HTML Standard. Living Standard. URL: https://html.spec.whatwg.org/multipage/ 
[LET-LOCALHOST-BE-LOCALHOST]
    Mike West. Let 'localhost' be localhost.. URL: https://tools.ietf.org/html/draft-west-let-localhost-be-localhost 
[RFC2119]
    S. Bradner. Key words for use in RFCs to Indicate Requirement Levels. March 1997. Best Current Practice. URL: https://tools.ietf.org/html/rfc2119 
[RFC4632]
    V. Fuller; T. Li. Classless Inter-domain Routing (CIDR): The Internet Address Assignment and Aggregation Plan. August 2006. Best Current Practice. URL: https://tools.ietf.org/html/rfc4632 
[URL]
    Anne van Kesteren. URL Standard. Living Standard. URL: https://url.spec.whatwg.org/ 
[W3C-PROCESS]
    Charles McCathie Nevile. World Wide Web Consortium Process Document. URL: https://www.w3.org/20145/Process-20150901/ 
[WebIDL]
    Boris Zbarsky. Web IDL. 15 December 2016. ED. URL: https://heycam.github.io/webidl/ 

●●ref_informative

[COMCAST]
    David Kravets. Comcast Wi-Fi serving self-promotional ads via JavaScript injection. URL: https://arstechnica.com/tech-policy/2014/09/why-comcasts-javascript-ad-injections-threaten-security-net-neutrality/ 
[CREDENTIAL-MANAGEMENT-1]
    Mike West. Credential Management Level 1. 17 January 2019. WD. URL: https://www.w3.org/TR/credential-management-1/ 
[DISCOVERY-API]
    Rich Tibbett. Network Service Discovery. 12 January 2017. NOTE. URL: https://www.w3.org/TR/discovery-api/ 
[ENCRYPTED-MEDIA]
    David Dorwin; et al. Encrypted Media Extensions. 18 September 2017. REC. URL: https://www.w3.org/TR/encrypted-media/ 
[FULLSCREEN]
    Philip Jägenstedt. Fullscreen API Standard. Living Standard. URL: https://fullscreen.spec.whatwg.org/ 
[GEOLOCATION-API]
    Andrei Popescu. Geolocation API Specification 2nd Edition. 8 November 2016. REC. URL: https://www.w3.org/TR/geolocation-API/ 
[IndexedDB]
    Nikunj Mehta; et al. Indexed Database API. 8 January 2015. REC. URL: https://www.w3.org/TR/IndexedDB/ 
[MEDIACAPTURE-STREAMS]
    Daniel Burnett; et al. Media Capture and Streams. 3 October 2017. CR. URL: https://www.w3.org/TR/mediacapture-streams/ 
[MIX]
    Mike West. Mixed Content. 2 August 2016. CR. URL: https://www.w3.org/TR/mixed-content/ 
[POWERFUL-NEW-FEATURES]
    Chrome Security Team. Prefer Secure Origins For Powerful New Features. URL: https://www.chromium.org/Home/chromium-security/prefer-secure-origins-for-powerful-new-features 
[RFC6265]
    A. Barth. HTTP State Management Mechanism. April 2011. Proposed Standard. URL: https://tools.ietf.org/html/rfc6265 
[RFC6761]
    S. Cheshire; M. Krochmal. Special-Use Domain Names. February 2013. Proposed Standard. URL: https://tools.ietf.org/html/rfc6761 
[RFC7258]
    S. Farrell; H. Tschofenig. Pervasive Monitoring Is an Attack. May 2014. Best Current Practice. URL: https://tools.ietf.org/html/rfc7258 
[SECURING-WEB]
    Mark Nottingham. Securing the Web. TAG Finding. URL: https://www.w3.org/2001/tag/doc/web-https 
[SERVICE-WORKERS]
    Alex Russell; et al. Service Workers 1. 2 November 2017. WD. URL: https://www.w3.org/TR/service-workers-1/ 
[VERIZON]
    Mark Bergen; Alex Kantrowitz. Verizon looks to target its mobile subscribers with ads. URL: http://adage.com/article/digital/verizon-target-mobile-subscribers-ads/293356/ 
[WEB-BLUETOOTH]
    Jeffrey Yasskin. Web Bluetooth. Draft Community Group Report. URL: https://webbluetoothcg.github.io/web-bluetooth/ 
[WEBCRYPTOAPI]
    Mark Watson. Web Cryptography API. 26 January 2017. REC. URL: https://www.w3.org/TR/WebCryptoAPI/ 


●●trans_metadata
<p>
~THIS_PAGEは、~W3Cにより編集者草案として公開された
<a href="~SPEC_URL">Secure Contexts</a>
を日本語に翻訳したものです。
~PUB
</p>


●●spec_metadata

最新発行バージョン
	https://www.w3.org/TR/secure-contexts/

編集者草案
	https://w3c.github.io/webappsec-secure-contexts/

以前のバージョン
	https://www.w3.org/TR/2016/CR-secure-contexts-20160915/
	https://www.w3.org/TR/2016/WD-secure-contexts-20160719/

バージョン履歴
	https://github.com/w3c/webappsec-secure-contexts/commits/master/index.src.html

フィードバック
	<span><a href="mailto:public-webappsec@w3.org?subject=%5Bsecure-contexts%5D%20YOUR%20TOPIC%20HERE">public-webappsec@w3.org</a> with subject line “<kbd>[secure-contexts] <i>… message topic …</i></kbd>” (<a href="https://lists.w3.org/Archives/Public/public-webappsec/" rel="discussion">archives</a>)</span>

編集
	<a href="mailto:mkwst@google.com">Mike West</a> (Google Inc.)

前任編集者
	Yan Zhu (Brave)

Participate:
	<a href="https://github.com/w3c/webappsec-secure-contexts/issues/new">File an issue</a> (<a href="https://github.com/w3c/webappsec-secure-contexts/issues">open issues</a>)

</script>


<!-- 
WEBSTORAGE
	http://www.w3.org/TR/webstorage/
WEOKERS:http://www.w3.org/TR/workers/
BROWSERS:http://www.w3.org/TR/html5/browsers.html
WAPI:http://www.w3.org/TR/html5/webappapis.html
WAPI:https://html.spec.whatwg.org/multipage/webappapis.html

-->


</head>

<body>

<!--%resource pool -->
<div id="_persisted_parts" hidden>

<svg id="_dgm-fig-01" height="200" width="400">
 <g transform="translate(10,10)">
  <rect class="non-secure" height="175" width="297" x="0" y="0"></rect>
  <text transform="translate(10, 20)">http://example.com/</text>
 </g>
</svg>

<svg id="_dgm-fig-02" height="200" width="400">
 <g transform="translate(10,10)">
  <rect class="secure" height="175" width="297" x="0" y="0"></rect>
  <text transform="translate(10, 20)">https://example.com/</text>
 </g>
</svg>

<svg id="_dgm-fig-03" height="400" width="400">
 <g transform="translate(10,10)">
  <rect class="secure" height="175" width="297" x="0" y="0"></rect>
  <text transform="translate(10, 20)">https://secure.example.com/</text>
 </g>
 <g transform="translate(10,210)">
  <rect class="secure" height="175" width="297" x="0" y="0"></rect>
  <text transform="translate(10, 20)">https://another.example.com/</text>
 </g>
 <g>
  <path d="M150, 87 C 200 75, 350 75, 150 287"></path>
 </g>
</svg>

<svg id="_dgm-fig-05" height="400" width="400">
 <g transform="translate(10,10)">
  <rect class="non-secure" height="175" width="297" x="0" y="0"></rect>
  <text transform="translate(10, 20)">http://non-secure.example.com/</text>
 </g>
 <g transform="translate(10,210)">
  <rect class="secure" height="175" width="297" x="0" y="0"></rect>
  <text transform="translate(10, 20)">https://another.example.com/</text>
 </g>
 <g>
  <path d="M150, 87 C 200 75, 350 75, 150 287"></path>
 </g>
</svg>


<svg id="_dgm-fig-06" height="200" width="400">
 <g transform="translate(10,10)">
  <rect class="secure" height="175" width="300" x="0" y="0"></rect>
  <text transform="translate(10, 20)">https://example.com/</text>
  <g transform="translate(20, 50)">
   <rect class="secure" height="105" width="250" x="0" y="0"></rect>
   <text transform="translate(10, 20)">https://sub.example.com/</text>
  </g>
 </g>
</svg>

<svg id="_dgm-fig-07" height="200" width="400">
 <g transform="translate(10,10)">
  <rect class="secure" height="175" width="300" x="0" y="0"></rect>
  <text transform="translate(10, 20)">https://example.com/</text>
  <g transform="translate(20, 50)">
   <rect class="non-secure" height="105" width="250" x="0" y="0"></rect>
   <text transform="translate(10, 20)">http://non-secure.example.com/</text>
  </g>
 </g>
</svg>

<svg id="_dgm-fig-08" height="200" width="400">
 <g transform="translate(10,10)">
  <rect class="non-secure" height="175" width="300" x="0" y="0"></rect>
  <text transform="translate(10, 20)">http://non-secure.example.com/</text>
  <g transform="translate(20, 50)">
   <rect class="non-secure" height="105" width="250" x="0" y="0"></rect>
   <text transform="translate(10, 20)">https://example.com/</text>
  </g>
 </g>
</svg>

<svg id="_dgm-fig-09" height="200" width="600">
 <g transform="translate(10,10)">
  <rect class="secure" height="175" width="300" x="0" y="0"></rect>
  <text transform="translate(10, 20)">https://example.com/</text>
  <g transform="translate(400, 110)">
   <circle class="secure" r="50"></circle>
   <text transform="translate(-75, -55)">https://example.com/worker.js</text>
  </g>
  <g>
   <path d="M150, 87 C 200 75, 350 75, 405 110"></path>
  </g>
 </g>
</svg>


<svg id="_dgm-fig-10" height="200" width="600">
 <g transform="translate(10,10)">
  <rect class="non-secure" height="175" width="297" x="0" y="0"></rect>
  <text transform="translate(10, 20)">http://non-secure.example.com/</text>
  <g transform="translate(20, 50)">
   <rect class="non-secure" height="105" width="250" x="0" y="0"></rect>
   <text transform="translate(10, 20)">https://example.com/</text>
  </g>
  <g transform="translate(400, 110)">
   <circle class="non-secure" r="50"></circle>
   <text transform="translate(-75, -55)">https://example.com/worker.js</text>
  </g>
  <g>
   <path d="M150, 87 C 200 75, 350 75, 405 110"></path>
  </g>
 </g>
</svg>

<svg id="_dgm-fig-11" height="200" width="600">
 <g transform="translate(10,10)">
  <rect class="secure" height="175" width="300" x="0" y="0"></rect>
  <text transform="translate(10, 20)">https://example.com/</text>
  <g transform="translate(400, 110)">
   <circle class="secure" r="50"></circle>
   <text transform="translate(-75, -55)">https://example.com/worker.js</text>
  </g>
  <g>
   <path d="M150, 87 C 200 75, 350 75, 405 110"></path>
  </g>
 </g>
</svg>

<svg id="_dgm-fig-12" height="400" width="600">
 <g transform="translate(10,10)">
  <rect class="secure" height="175" width="300" x="0" y="0"></rect>
  <text transform="translate(10, 20)">https://example.com/</text>
  <g transform="translate(400, 110)">
   <circle class="secure" r="50"></circle>
   <text transform="translate(-75, -55)">https://example.com/worker.js</text>
  </g>
  <g>
   <path d="M150, 87 C 200 75, 350 75, 405 110"></path>
  </g>
 </g>
 <g transform="translate(10,200)">
  <rect class="secure" height="175" width="300" x="0" y="0"></rect>
  <text transform="translate(10, 20)">https://example.com/</text>
  <g>
   <path d="M150, 87 C 200 75, 350 75, 405 -80"></path>
  </g>
 </g>
</svg>

<svg id="_dgm-fig-13" height="400" width="600">
 <g transform="translate(10,10)">
  <rect class="secure" height="175" width="300" x="0" y="0"></rect>
  <text transform="translate(10, 20)">https://example.com/</text>
  <g transform="translate(400, 110)">
   <circle class="secure" r="50"></circle>
   <text transform="translate(-75, -55)">https://example.com/worker.js</text>
  </g>
  <g>
   <path d="M150, 87 C 200 75, 350 75, 405 110"></path>
  </g>
 </g>
 <g transform="translate(10,200)">
  <rect class="non-secure" height="175" width="300" x="0" y="0"></rect>
  <text transform="translate(10, 20)">http://non-secure.example.com/</text>
  <g transform="translate(20, 50)">
   <rect class="non-secure" height="105" width="250" x="0" y="0"></rect>
   <text transform="translate(10, 20)">https://example.com/</text>
  </g>
  <g>
   <path d="M150, 87 C 200 75, 350 75, 405 20"></path>
   <text class="rejection" transform="translate(405, 20)">X</text>
  </g>
 </g>
</svg>


<svg id="_dgm-fig-14" height="400" width="600">
 <g transform="translate(10,10)">
  <rect class="non-secure" height="175" width="300" x="0" y="0"></rect>
  <text transform="translate(10, 20)">http://non-secure.example.com/</text>
  <g transform="translate(20, 50)">
   <rect class="non-secure" height="105" width="250" x="0" y="0"></rect>
   <text transform="translate(10, 20)">https://example.com/</text>
  </g>
  <g transform="translate(400, 110)">
   <circle class="non-secure" r="50"></circle>
   <text transform="translate(-75, -55)">https://example.com/worker.js</text>
  </g>
  <g>
   <path d="M150, 87 C 200 75, 350 75, 405 110"></path>
  </g>
 </g>
 <g transform="translate(10,200)">
  <rect class="secure" height="175" width="300" x="0" y="0"></rect>
  <text transform="translate(10, 20)">https://example.com/</text>
  <g>
   <path d="M150, 87 C 200 75, 350 75, 405 20"></path>
   <text class="rejection" transform="translate(405, 20)">X</text>
  </g>
 </g>
</svg>

<svg id="_dgm-fig-15" height="200" width="600">
 <g transform="translate(10,10)">
  <rect class="secure" height="175" width="300" x="0" y="0"></rect>
  <text transform="translate(10, 20)">https://example.com/</text>
  <g transform="translate(400, 110)">
   <circle class="secure" r="50"></circle>
   <text transform="translate(-75, -55)">https://example.com/service.js</text>
  </g>
  <g>
   <path d="M150, 87 C 200 75, 350 75, 405 110"></path>
  </g>
 </g>
</svg>


</div>

<header>



	<hgroup>
<h1 id="title">保安的文脈 — Secure Contexts</h1>
	</hgroup>
</header>

<div id="MAIN" hidden>

	<section id="abstract">
<h2 title="Abstract">要約</h2>

<p>
この仕様は、 “保安的~文脈” を定義する。
それにより，~UAの実装者や仕様の策定者は、一定の最小限の標準による認証と機密性が満たされるときに限り，一定の特能を可能化できるようになる。
◎
This specification defines "secure contexts", thereby allowing user agent implementers and specification authors to enable certain features only when certain minimum standards of authentication and confidentiality are met.
</p>

	</section>
	<section id="status">
<h2 title="Status of this document">この文書の位置付け</h2>

<p>
これは編集者草案の公開の複製です…
【以下、この節の他の内容は <a href="w3c-common-ja.html#status" >W3C 日本語訳 共通ページ</a>に委譲。】
</p>

<p>
この文書に対する変更点は
<a href="https://github.com/w3c/webappsec">https://github.com/w3c/webappsec</a>
にて追跡できます。
◎
Changes to this document may be tracked at https://github.com/w3c/webappsec.
</p>

<p>
この文書は
<a href="https://www.w3.org/2011/webappsec/">Web Application Security Working Group</a>
により制作されました。
◎
This document was produced by the Web Application Security Working Group.
</p>

<p>
次の特能は
<a href="w3c-common-ja.html#at-risk">~risk下</a>
にあり，勧告候補の期間~中に落とされるかもしれません：
◎
The following features are at-risk, and may be dropped during the CR period:
</p>

<ul>
	<li>
<a href="#monkey-patching-sandbox-flags">~sandbox法</a>
節に定義される `閲覧文脈~sandbox化( 保安的 )~flag$, および
`環境~設定群~objは保安的~文脈を与えるか？$における その用法。
 [<a href="#issue-sandboxing">Issue 2</a>]
◎
The sandboxed secure browsing context flag defined in §2.2.1 Sandboxing, as well as its usage in §3.1 Is an environment settings object contextually secure?. [Issue 2]
</li>
</ul>

	</section>

<main id="MAIN0">

	<section id="intro">
<h2 title="Introduction">1. 序論</h2>

~INFORMATIVE

<p>
~web~platformが拡張され，より有用かつ強力な応用が可能化されるに伴い、［
その種の応用を可能化する特能は、最小限の保安~levelを満たす文脈に限り，可能化される
］ことを確保することが，ますます重要になっている。
この文書は
— `SECURING-WEB$r における TAG の推奨の拡張として —
~web上で特能を濫用する脅威~modelについて述べる（
<a href="#threat-models">脅威~model</a>
節を見よ）とともに、新たな特能を仕様化している文書に組入れるべき，規範的~要件について概説する（
<a href="#implementation-considerations">実装にあたっての考慮点</a>
を見よ）。
◎
As the web platform is extended to enable more useful and powerful applications, it becomes increasingly important to ensure that the features which enable those applications are enabled only in contexts which meet a minimum security level. As an extension of the TAG’s recommendations in [SECURING-WEB], this document describes threat models for feature abuse on the web (see §4.1 Threat Models) and outlines normative requirements which should be incorporated into documents specifying new features (see §7 Implementation Considerations).
</p>

<p>
ここで論じられる要件のうち，最も明らかなものは、敏感あるいは私的な~dataへの~accessを伴う~app~codeが、~data完全性を保証する認証-済み~channel越しに，機密的に送達されることである。
~codeを保安的に送達することは、［
その~appが，利用者の保安や~privacy要件を満たす
］ことを常に確保するわけではないが，必要とされる前提条件である。
◎
The most obvious of the requirements discussed here is that application code with access to sensitive or private data be delivered confidentially over authenticated channels that guarantee data integrity. Delivering code securely cannot ensure that an application will always meet a user’s security and privacy requirements, but it is a necessary precondition.
</p>

<p>
もう少し明らかでないことは、~app~codeが認証-済みかつ機密的な~channel越しに送達されるだけでは、強力な特能に対する 非保安的~文脈からの利用を制限するには，十分でないことである。
<a href="#ancestors">先祖による~risk</a>
節に説明するように、協同する~frameを濫用することにより，さもなければ堅固な［
特能に対する制約
］は迂回され得る。
以下に定義される各種~algoは、これらの迂回を困難かつ利用者から可視にすることを確保する。
◎
Less obviously, application code delivered over an authenticated and confidential channel isn’t enough in and of itself to limit the use of powerful features by non-secure contexts. As §4.2 Ancestral Risk explains, cooperative frames can be abused to bypass otherwise solid restrictions on a feature. The algorithms defined below ensure that these bypasses are difficult and user-visible.
</p>

<p>
以下に示す例に、後述の規範的~textを要約する：
◎
The following examples summarize the normative text which follows:
</p>



		<section id="examples-top-level">
<h3 title="Top-level Documents">1.1. ~top-level文書</h3>

<div class="example">

<p>
`~top-level閲覧文脈$内に開いた
`http://example.com/^s
は、認証-済みかつ暗号化された~channel越しに送達されていないので，`保安的~文脈$にならない。
◎
http://example.com/ opened in a top-level browsing context is not a secure context, as it was not delivered over an authenticated and encrypted channel.
</p>

`fig-01^dgm

</div>

<div class="example">

<p>
`~top-level閲覧文脈$内に開いた
`https://example.com/^s
は、認証-済みかつ暗号化された~channel越しに送達されたので，`保安的~文脈$になる。
◎
https://example.com/ opened in a top-level browsing context is a secure context, as it was delivered over an authenticated and encrypted channel.
</p>


`fig-02^dgm

</div>

<div class="example">

<p>
保安的~文脈が，新たな~window内に
`https://example.com/^s
を開いた場合、その新たな~windowは，それ自体が保安的なので 保安的~文脈になる。
◎
If a secure context opens https://example.com/ in a new window, that new window will be a secure context, as it is secure on its own merits:
</p>

`fig-03^dgm



</div>

<div class="example">

<p>
同様に、非保安的な文脈が，新たな~window内に
`https://example.com/^s
を開いた場合、その~windowは保安的になる
— それを開いた側が非保安的でも：
◎
Likewise, if a non-secure context opens https://example.com/ in a new window, that new window will be a secure context, even through its opener was non-secure:
</p>

`fig-05^dgm

</div>



		</section>
		<section id="examples-framed">
<h3 title="Framed Documents">1.2. ~frame内の文書</h3>

<p>
~frame内の文書は、それが［
`信用に価し得る生成元$から送達されたものであって, なおかつ
`保安的~文脈$内に埋込まれている
］ならば、`保安的~文脈$になれる。
すなわち：
◎
Framed documents can be secure contexts if they are delivered from potentially trustworthy origins, and if they’re embedded in a secure context. That is:
</p>

<div class="example">

<p>
`~top-level閲覧文脈$内に開かれた
`https://example.com/^s が
~frame内に
`https://sub.example.com/^s
を開いた場合、両者とも，認証-済みかつ暗号化された~channel越しに送達されたので、`保安的~文脈$になる。
◎
If https://example.com/ opened in a top-level browsing context opens https://sub.example.com/ in a frame, then both are secure contexts, as both were delivered over authenticated and encrypted channels. 
</p>

`fig-06^dgm

</div>

<div class="example">
<p>
`https://example.com/^s が，どうにかして
`http://non-secure.example.com/^s
を~frame内に入れれた場合（おそらく、利用者が混在~内容の検査-法を上書きしたがため？）、~top-level~frameは，保安的であり続けるが、~frame内の内容は保安的~文脈にならない。
◎
If https://example.com/ was somehow able to frame http://non-secure.example.com/ (perhaps the user has overridden mixed content checking?), the top-level frame would remain secure, but the framed content is not a secure context.
</p>

`fig-07^dgm


</div>

<div class="example">

<p>
一方で、
`http://non-secure.example.com/^s
の内側の~frame内に入れられた
`https://example.com/^s
は、保安的~文脈に<em>ならない</em>
— その先祖は、認証-済みかつ暗号化された~channel越しに送達されてないので。
◎
If, on the other hand, https://example.com/ is framed inside of http://non-secure.example.com/, then it is not a secure context, as its ancestor is not delivered over an authenticated and encrypted channel.
</p>


`fig-08^dgm

</div>



		</section>
		<section id="examples-workers">
<h3 title="Web Workers">1.3. ~web~worker</h3>

<p>
`専用~worker$は、その資質から~frame内の文書と類似する。
それは、［
`信用に価し得る生成元$から送達され, なおかつ
その所有者~自身も`保安的~文脈$である
］ときに限り、`保安的~文脈$になる：
◎
Dedicated Workers are similar in nature to framed documents. They’re secure contexts when they’re delivered from potentially trustworthy origins, only if their owner is itself a secure context:
</p>

<div class="example">

<p>
`~top-level閲覧文脈$内の
`https://example.com/^s
が
`https://example.com/worker.js^s
を走らせた場合、その文書, ~workerの両者とも`保安的~文脈$になる。
◎
If https://example.com/ in a top-level browsing context runs https://example.com/worker.js, then both the document and the worker are secure contexts.
</p>

`fig-09^dgm


</div>

<div class="example">


<p>
`~top-level閲覧文脈$内の
`http://non-secure.example.com/^s
が
`https://example.com/^s
を~frame内に入れていて，後者が
`https://example.com/worker.js^s
を走らせた場合、~frame内の文書, ~workerの両者とも，`保安的~文脈$にならない。
◎
If http://non-secure.example.com/ in a top-level browsing context frames https://example.com/, which runs https://example.com/worker.js, then neither the framed document nor the worker are secure contexts.
</p>


`fig-10^dgm


</div>



		</section>
		<section id="examples-shared-workers">
<h3 title="Shared Workers">1.4. 共用~worker</h3>


<div class="p">
<p>
`共用~worker$ %S は、複数の文脈に添付され得る：
</p>

<ul>
	<li>
%S を作成したのが`保安的~文脈$ならば、
%S は`保安的~文脈$になり，
%S が添付されてよい文脈は `保安的~文脈$に限られる。
</li>
	<li>
%S を作成したのが非保安的~文脈ならば、
%S は`保安的~文脈$には<em>ならず</em>，
%S が添付されてよい文脈は 非保安的~文脈に限られる。
</li>
</ul>

◎
Multiple contexts may attach to a Shared Worker. If a secure context creates a Shared Worker, then it is a secure context, and may only be attached to by other secure contexts. If a non-secure context creates a Shared Worker, then it is not a secure context, and may only be attached to by other non-secure contexts.
</div>

<div class="example">

<p>
`~top-level閲覧文脈$内の
`https://example.com/^s
が
`https://example.com/worker.js^s
を共用~workerとして走らせた場合、
その文書と~workerの両者とも，保安的~文脈と見なされる。
◎
If https://example.com/ in a top-level browsing context runs https://example.com/worker.js as a Shared Worker, then both the document and the worker are considered secure contexts.
</p>


`fig-11^dgm


</div>

<div class="example">

<p>
異なる`~top-level閲覧文脈$内（例：新たな~window内）の
`https://example.com/^s
は，いずれも保安的~文脈になるので、保安的な共用~workerに~accessできる：
◎
https://example.com/ in a different top-level browsing context (e.g. in a new window) is a secure context, so it may access the secure shared worker:
</p>

`fig-12^dgm


</div>

<div class="example">

<p>
`http://non-secure.example.com/^s
内に入子にされた
`https://example.com/^s
は、保安的~文脈でないので，保安的~workerには接続できない：
◎
https://example.com/ nested in http://non-secure.example.com/ may not connect to the secure worker, as it is not a secure context.
</p>


`fig-13^dgm


</div>

<div class="example">

<p>
同様に、
`http://non-secure.example.com/^s
内に入子にされた
`https://example.com/^s
が，
`https://example.com/worker.js^s
を共用~workerとして走らせた場合、
その文書と~workerの両者とも非保安的と見なされる。
◎
Likewise, if https://example.com/ nested in http://non-secure.example.com/ runs https://example.com/worker.js as a Shared Worker, then both the document and the worker are considered non-secure.
</p>

`fig-14^dgm


</div>



		</section>
		<section id="examples-service-workers">
<h3 title="Service Workers">1.5. ~service~worker</h3>

<p>
~service~workerは、常に`保安的~文脈$になる。
~service~workerを登録できるのは，`保安的~文脈$に限られ、~service~workerの~clientもまた，`保安的~文脈$に限られる。
◎
Service Workers are always secure contexts. Only secure contexts may register them, and they may only have clients which are secure contexts.
</p>

<div class="example">

<p>
`~top-level閲覧文脈$内の
`https://example.com/^s
が
`https://example.com/service.js^s
を登録した場合、
文書と~service~workerの両者とも保安的~文脈と見なされる。
◎
If https://example.com/ in a top-level browsing context registers https://example.com/service.js, then both the document and the Service Worker are considered secure contexts.
</p>

`fig-15^dgm


</div>

		</section>
	</section>
	<section id="framework">
<h2 title="Framework">2. ~framework</h2>

<p>
`環境~設定群~obj$は、`保安的~文脈を与え$るならば
`保安的~文脈@
と見なされ，他の場合は
`非保安的~文脈@
と見なされる。
◎
Environment settings objects are considered to be secure contexts if they are contextually secure as defined in §3.1 Is an environment settings object contextually secure?, and non-secure contexts otherwise.
</p>

<p>
同様に，`大域~obj$（ `Window$I, `WorkerGlobalScope$I, 等々）は、それに`関連する設定群~obj$が`保安的~文脈を与え$るならば `保安的~文脈$と見なされ，他の場合は `非保安的~文脈$と見なされる。
◎
Likewise, a global object (Window, WorkerGlobalScope, etc.) is considered to be a secure context if its relevant settings object is contextually secure as defined in §3.1 Is an environment settings object contextually secure?, and a non-secure context otherwise.
</p>



		<section id="integration-idl">
<h3 title="Intergration with WebIDL">2.1.  WebIDL との統合</h3>

~INFORMATIVE

<p>
~interface／~interface~memberに対しては
[`SecureContext$] 拡張属性が新たに可用にされている。
それは、当の
~interface／~member
が，保安的~文脈に限り`公開され$ることを確保する。
次の例のように：
◎
A new [SecureContext] attribute is available for operators, which ensures that they will only be exposed into secure contexts. The following example should help:
</p>

<div class="example">

<pre class="idl">
interface ExampleFeature {
  /* <span class="comment">
この~callはすべての文脈で成功する。
◎
This call will succeed in all contexts.
</span> */
  Promise &lt;double&gt; calculateNotSoSecretResult();

  /* <span class="comment">
この演算は非保安的~文脈には公開されない。
◎
This operation will not be exposed to a non-secure context.
</span> */
  [`SecureContext$] Promise&lt;double&gt; calculateSecretResult();

  /* <span class="comment">
同様に次の演算も，非保安的~文脈には公開されない。
◎
The same applies here: the operation will not be exposed to a non-secure context.
</span> */
  [`SecureContext$] boolean getSecretBoolean();
};

[`SecureContext$] interface SecureFeature {
  /* <span class="comment">
この~interfaceは非保安的~文脈には公開されない。
◎
This interface will not be exposed to non-secure contexts.
</span> */
  Promise&lt;any&gt; doAmazingThing();
};

</pre>

</div>

<p>
仕様の策定者には、新たな特能を定義するときは，この拡張属性を利用することが奨励される。
◎
Specification authors are encouraged to use this attribute when defining new features.
</p>



		</section>
		<section id="monkey-patching-html">
<h3 title="Modifications to HTML">2.2. ~HTMLに対する改変</h3>

			<section id="monkey-patching-sandbox-flags">
<h4 title="sandboxing">2.2.1. ~sandbox法</h4>

<p>
開発者は、~sandbox化された`閲覧文脈$を 状況によっては`保安的~文脈$に扱い，他の場合は`非保安的~文脈$に扱いたいと望むこともあろう。
次の~sandbox法~flagが，それを~supportする：
◎
Developers may wish to treat sandboxed browsing contexts as secure contexts in some situations, and non-secure contexts in others. The following sandboxing flag supports this desire:
</p>

<dl>
	<dt>
`閲覧文脈~sandbox化( 保安的 )~flag@
◎
The sandboxed secure browsing context flag
</dt>
	<dd>
この~flagは、［
当の閲覧文脈~内の内容は，`非保安的~文脈$と扱われる
］ものと表明する
— 他では保安的と見なされる内容に対しても。
◎
This flag asserts that content in a browsing context will be treated as a non-secure context, even if it would otherwise be considered secure.
</dd>

</dl>

<p>
`~sandbox法~指令を構文解析する$ ~algoは、次のように拡張される
⇒
［
~algoの最後の， %tokens を一連の~flagに構文解析する段
］の最後に，次の段を追加する：
◎
The parse a sandboxing directive algorithm is extended by adding the following entry to the list in the final step of the algorithm which parses tokens into flags:
</p>

<ul>
	<li>
<p>
次が満たされるならば，`閲覧文脈~sandbox化( 保安的 )~flag$も %出力 に追加する
⇒
`allow-secure-context@v
~NIN %tokens
◎
The sandboxed secure browsing context flag, unless tokens contains the allow-secure-context keyword.
</li>
</ul>

<p class="issue" id="issue-sandboxing">
この特能は “~risk下” にあり、下の~link先に述べる課題の解決を待っている（それ自体も各~browser~vendorからの~~評価を待っている）。
そのため、これは WHATWG の~HTMLも W3Cの~HTMLも~~規範にしない。
この特能を保つかどうか決まったときは、それについて取りかかることになる。
<a href="https://github.com/w3c/webappsec-secure-contexts/issues/28">&lt;https://github.com/w3c/webappsec-secure-contexts/issues/28&gt;</a>
◎
This feature is "at risk", pending the resolution of the linked issue (which itself is pending metrics gathered from browser vendors). Accordingly, no attempt has been made to upstream this to either WHATWG’s HTML or W3C’s HTML. Once we’ve decided whether or not to keep the feature, we’ll work on that. &lt;https://github.com/w3c/webappsec-secure-contexts/issues/28&gt;
</p>


			</section>
			<section id="shared-workers">
<h4 title="Shared Workers">2.2.2. 共用~worker</h4>

~INFORMATIVE

<p>
`SharedWorker$I の構築子は、［
`保安的~文脈$が`保安的~文脈$でない~workerを添付しようと試みた
］とき, および［
非保安的~文脈が`保安的~文脈$である~workerを添付しようと試みた
］ときには、 `SecurityError^E 例外を投出することになる。
◎
The SharedWorker constructor will throw a SecurityError exception if a secure context attempts to attach to an Worker which is not a secure context, and if a non-secure context attempts to attach to a Worker which is a secure context.
</p>


<p class="issue">
これは、現在は WHATWG による~HTMLの
Step 11.4.2
【和訳では，編集の都合により <a href="~WORKERS#dom-sharedworker">構築子</a>の段 11.1.3 】
に定義されている（
<a href="https://github.com/whatwg/html/pull/1560">whatwg/html#1560</a>
にて策定された）。
W3C によるその~algoにはまだ取り込まれていない（
<a href="https://github.com/w3c/workers/issues/6">&lt;https://github.com/w3c/workers/issues/6&gt;</a>
）。
◎
This is currently defined in Step 11.4.2 of the WHATWG’s HTML (landed in whatwg/html#1560. It has not yet been picked up by the W3C’s version of that algorithm. &lt;https://github.com/w3c/workers/issues/6&gt;
</p>

			</section>
			<section id="monkey-patching-global-object">
<h4 title="Feature Detection">2.2.3. 特能の検出</h4>

<p>
~appは、自身が`保安的~文脈$内で実行されているかどうかを，`大域~obj$上の単純な~boolean属性を検査して決定できる：
◎
An application can determine determine whether it’s executing in a secure context by checking a simple boolean attribute on the global object:
</p>

<pre class="idl" id="_idl-WindowOrWorkerGlobalScope">
partial interface mixin `WindowOrWorkerGlobalScope$I {
  readonly attribute boolean `isSecureContext$m;
};
</pre>

<p class="idl-def">
`isSecureContext@m
属性の取得子は、此れに`関連する設定群~obj$は`保安的~文脈を与え$るならば ~T ／
~ELSE_ ~F
］を返す。
◎
The isSecureContext attribute’s getter returns true if this global object's relevant settings object is contextually secure, and false otherwise.
</p>

			</section>
		</section>
	</section>
	<section id="algorithms">
<h2 title="Algorithms">3. 各種~algo</h2>



		<section id="is-settings-object-contextually-secure">
<h3 title="Is an environment settings object contextually secure?">3.1. 環境~設定群~objは保安的~文脈を与えるか？</h3>

<p id="settings-object">
所与の
( `環境~設定群~obj$ %設定群 )
は、［
次に与える~algoが `保安的^i を返す
］とき, そのときに限り，
`保安的~文脈を与え@
ると見なされる（その否定は “与え<em >ない</em>” ）：
◎
An environment settings object (settings) is considered contextually secure if and only if the following Is settings contextually secure? algorithm returns "Secure":
</p>

<ol>
	<li>
%大域~obj ~LET %設定群 の`大域~obj$enV
◎
Let global be settings’s global object.
</li>
	<li>
<p>
~IF［
%大域~obj は `WorkerGlobalScope$I ~objである
］：
◎
If global is a WorkerGlobalScope, then:
</p>

		<ol>
			<li>
<p>
%大域~obj の`所有者~集合$内の~EACH ( `Document$I ~obj %文書 ) に対し：
◎
For each Document (document) in global’s owner set:
</p>

				<ol>
					<li>
~Assert：
~workerは，それを作成した文脈と同一-生成元であり、したがって
%文書 に`関連する設定群~obj$の［
`生成元$enV, `~HTTPS状態$enV
］は
%大域~obj に`関連する設定群~obj$の それらと同じである
◎
Assert: Workers must be same-origin with the context that created them, so document’s relevant settings object's origin and HTTPS state is the same as global’s relevant settings object's origin and HTTPS state.
</li>
					<li>
~IF［
%文書 に`関連する設定群~obj$は`保安的~文脈を与え$る
］
⇒
~CONTINUE
◎
If document’s relevant settings object is not contextually secure, return "Not Secure".
</li>
					<li>
~RET `非~保安的^i
◎
↑</li>
				</ol>
			</li>
			<li>
<p>
~RET `保安的^i
◎
Return "Secure".
</p>

<p class="note">注記：
上の ~Assert が与えられた下で，この段に達した場合、当の~workerは`保安的~文脈$から作成されたものであり，したがって自身も`保安的~文脈$にならなければならない。
◎
Note: Given the assertion above, if we’ve reached this step, the worker must have been created from a secure context, and therefore must itself be a secure context.
</p>
			</li>
		</ol>
	</li>
	<li>
~Assert：
%大域~obj は `Window$I ~objである
◎
Assert: global is a Window.
</li>
	<li>
%文書 ~LET %設定群 の`担当の文書$enV
◎
Let document be settings’s responsible document.
</li>
	<li>
%S ~LET %文書 の`作動中の~sandbox法~flag集合$
◎
↓</li>
	<li>
<p>
~IF［
次のいずれかが満たされる
］
⇒
~RET `非~保安的^i ：
◎
Return "Not Secure" if any of the following are true:
</p>

		<ul>
			<li>
<p>
`閲覧文脈~sandbox化( 保安的 )~flag$ ~IN %S
◎
document’s active sandboxing flag set contains the sandboxed secure browsing context flag.
</p>

<p class="note">注記：
この検査は “~risk下” にある。
詳細は
<a href="#monkey-patching-sandbox-flags">~sandbox法</a>
節を見よ。
◎
Note: This check is "at risk". See §2.2.1 Sandboxing for details.
</p>
			</li>
			<li>
［
%文書 の`親~閲覧文脈$ %文脈 ~NEQ ε
］~AND［
%文脈 にて`作動中の文書$に`関連する設定群~obj$は `保安的~文脈を与え$ない
］
◎
document has a parent browsing context (context), and context’s active document's relevant settings object is not contextually secure.
</li>
			<li>
%設定群 の`~HTTPS状態$enV ~EQ `deprecated^l
◎
settings’s HTTPS state is "deprecated".
</li>
			<li>
<p>
［
`閲覧文脈~sandbox化( 生成元 )~flag$ ~IN %S
］~AND［
`~URLは信用に価し得るか？$( %設定群 の`作成時の~URL$enV )
~EQ `価しない^i
］
◎
document’s active sandboxing flag set includes the sandboxed origin browsing context flag, and §3.3 Is url potentially trustworthy? returns "Not Trustworthy" when executed upon settings’s creation URL.
</p>

<p class="note">注記：
ここでは、`作成時の~URL$enVを検査する
— ~sandbox化された内容であって，不透明な生成元~内にあると扱われるもの（例：
`&lt;iframe sandbox="allow-secure-context" src="http://127.0.0.1/"&gt;^s
）は、さもなければ，`生成元は信用に価し得るか？$により信用に価しないものと扱われるので。
~sandbox法は，内容の能力を抑制するのみであり、
and therefore in the risk it poses,【？】
［
~sandbox化されていないときに，それを信用に価すると見なすことになる
］かどうかを決定するため，その~URLの生成元を診る。
◎
Note: We check the creation URL here because sandboxed content that is treated as being in an opaque origin (e.g. &lt;iframe sandbox="allow-secure-context" src="http://127.0.0.1/"&gt;) would otherwise be treated as non-trustworthy by §3.2 Is origin potentially trustworthy?. Since sandboxing is a strict reduction in the content’s capabilities, and therefore in the risk it poses, we look at the origin of its URL to determine whether we would have considered it trustworthy had it not been sandboxed.
</p>
			</li>
			<li>
［
`閲覧文脈~sandbox化( 生成元 )~flag$ ~NIN %S
］~AND［
`生成元は信用に価し得るか？$( %設定群 の`生成元$enV )
~EQ `価しない^i
］
◎
document’s active sandboxing flag set does not include the sandboxed origin browsing context flag, and §3.2 Is origin potentially trustworthy? returns "Not Trustworthy" when executed upon settings’s origin.
</li>
		</ul>
	</li>
	<li>
~RET `保安的^i
◎
Return "Secure".
</li>
</ol>

		</section>
		<section id="is-origin-trustworthy">
<h3 title="Is origin potentially trustworthy? ">3.2. 生成元は信用に価し得るか? </h3>

<p>
`信用に価し得る生成元@
（ `potentially trustworthy origin^en ）とは、~dataは保安的に送達されているものと，~UAが一般に信用できるものである。
◎
A potentially trustworthy origin is one which a user agent can generally trust as delivering data securely.
</p>

<p>
この節に述べる~algoは、伝統的~感覚では［
認証され, かつ暗号化されるもの
］でないかもしれないような，ある種の［
~host ／ ~scheme ／ 生成元
］に対しても、信用に価し得ると見なす。
特に，~UAは、 `file^sc ~URLを信用に価し得るものと扱うべきである。
原則的には、~UAは，局所~fileを信用に価しないものと扱うこともできるが、<em>~UAに可用な情報が 実行時に与えられている下では</em>，資源は~diskから~UAに保安的に~transportされたように現れる。
加えて，公共に配備する前の~appを築いている開発者にとっては、そのような資源を信用に価し得るものと扱えた方が，簡便になる。
◎
This algorithms considers certain hosts, scheme, and origins as potentially trustworthy, even though they might not be authenticated and encrypted in the traditional sense. In particular, the user agent SHOULD treat file URLs as potentially trustworthy. In principle the user agent could treat local files as untrustworthy, but, given the information that is available to the user agent at runtime, the resources appear to have been transported securely from disk to the user agent. Additionally, treating such resources as potentially trustworthy is convenient for developers building an application before deploying it to the public.
</p>

<p>
しかしながら、この開発者への親切さに~riskがないわけではない。
そのような作り込みより保安を優先する~UAは、より厳格に，
`file^sc を除外する仕方で信用をアテガってもヨイ。
◎
This developer-friendlyness is not without risk, however. User agents which prioritize security over such niceties MAY choose to more strictly assign trust in a way which excludes file.
</p>

<p>
他方、~UAは，この信用を，自身が <em>先天的に</em> 信用-済みであると決定できる他の~URL~scheme
— `app^sc や `chrome-extension^sc の様な~vendor特有の~URL~scheme —
にまで拡張してもヨイ（詳細は
<a href="#packaged-applications">~package化~app</a>
節を見よ
）。
◎
On the other hand, the user agent MAY choose to extend this trust to other, vendor-specific URL schemes like app: or chrome-extension: which it can determine a priori to be trusted (see §7.1 Packaged Applications for detail).
</p>

<p>
次の~algoは、所与の
( `生成元$ %生成元 )
に対し，信用に［
`価し得る^i ／ `価しない^i
］いずれか適切な方を返す：
◎
Given an origin (origin), the following algorithm returns "Potentially Trustworthy" or "Not Trustworthy" as appropriate.
</p>

<ol>
	<li>
~IF［
%生成元 は`不透明な生成元$である
］
⇒
~RET `価しない^i
◎
If origin is an opaque origin, return "Not Trustworthy".
</li>
	<li>
~Assert：
%生成元 は`成分組~生成元$である
◎
Assert: origin is a tuple origin.
</li>
	<li>
( %~scheme, %~host ) ~LET %生成元 の ( `~scheme$, `~host$ )
◎
↓</li>
	<li>
<p>
~IF［
次のいずれかが満たされる
］
⇒
~RET `価し得る^i：
◎
↓</p>
		<ul>
			<li>
<p>
%~scheme ~IN { `https^l, `wss^l }
◎
If origin’s scheme is either "https" or "wss", return "Potentially Trustworthy".
</p>

<p class="note">注記：
これは、 `MIX$r における`先天的に認証-済み~URL$の概念に相似するよう意味されている。
◎
Note: This is meant to be analog to the a priori authenticated URL concept in [MIX].
</p>
			</li>
			<li>
%~host は，
CIDR 記法による［
`127.0.0.0/8^c, `::1/128^c
］いずれかに合致する
`RFC4632$r
◎
If origin’s host component matches one of the CIDR notations 127.0.0.0/8 or ::1/128 [RFC4632], return "Potentially Trustworthy".
</li>
			<li>
<p>
［［
%~host ~EQ `localhost^l
］~OR［
%~host は `.localhost^l に類する
］］~AND［
~UAは `let-localhost-be-localhost$r による名前~解決 規則に適合する
］
◎
If origin’s host component is "localhost" or falls within ".localhost", and the user agent conforms to the name resolution rules in [let-localhost-be-localhost], return "Potentially Trustworthy".
</p>

<p class="note">注記：
この要件の詳細は、<a href="#localhost">~localhost節</a>を見よ。
◎
Note: See §5.2 localhost for details on the requirements here.
</p>
			</li>
			<li>
%~scheme ~EQ `file^l
◎
If origin’s scheme component is file, return "Potentially Trustworthy".
</li>
			<li>
<p>
%~scheme は ~UAが認証-済みと見なすものである
◎
If origin’s scheme component is one which the user agent considers to be authenticated, return "Potentially Trustworthy".
</p>

<p class="note">注記：
詳細は
<a href="#packaged-applications">~package化~app</a>
節を見よ。
◎
Note: See §7.1 Packaged Applications for detail here.
</p>
			</li>
			<li>
<p>
%生成元 は 信用に価するものと環境設定されている
◎
If origin has been configured as a trustworthy origin, return "Potentially Trustworthy".
</p>

<p class="note">注記：
詳細は
<a href="#development-environments">開発~環境</a>
節を見よ。
◎
Note: See §7.2 Development Environments for detail here.
</p>
			</li>
		</ul>
	</li>
	<li>
~RET `価しない^i
◎
Return "Not Trustworthy".
</li>
</ol>

<p class="note">注記：
%生成元 の［
`~domain$, `~port$
］は、いずれも，`保安的~文脈$と見なされるかどうかには効果はない。
◎
Note: Neither origin’s domain nor port has any effect on whether or not it is considered to be a secure context.
</p>

		</section>
		<section id="is-url-trustworthy">
<h3 title="Is url potentially trustworthy? ">3.3. ~URLは信用に価し得るか？</h3>

<p>
`信用に価し得る~URL@
とは、作成元から文脈を継承するもの（
`about:blank^l, `about:srcdoc^l
），または［
`生成元$urlが`信用に価し得る生成元$
］なるものである。
次の~algoは、所与の
( `~URL$ %url )
に対し，信用に［
`価し得る^i ／ `価しない^i
］いずれか適切な方を返す：
◎
A potentially trustworthy URL is one which either inherits context from it’s creator (about:blank, about:srcdoc) or one whose origin is a potentially trustworthy origin. Given a URL (url), the following algorithm returns "Potentially Trustworthy" or "Not Trustworthy" as appropriate:
</p>

<ol>
	<li>
<p>
~IF［
%url の`~scheme$url ~EQ `data^l
］
⇒
~RET `価しない^i
◎
If url’s scheme is "data", return "Not Trustworthy".
</p>

<p class="note">注記：
これは、現今の各 主流~browserが同意している［
`不透明な生成元$としての `data^sc ~URL
］に対する事実上（ `de facto^en ）の挙動による，`保安的~文脈$の定義に倣う
— ［
`data^sc ~URLは~HTMLにて定義される生成元の挙動を継承する
］とする，規則上の（ `de jure^en ）それではなく。
◎
Note: This aligns the definition of a secure context with the de facto "data: URL as opaque origin" behavior that a majority of today’s browsers have agreed upon, rather than the de jure "data: URL inherits origin" behavior defined in HTML.
</p>
	</li>
	<li>
~IF［
%url ~IN { `about:blank^l, `about:srcdoc^l }
］
⇒
~RET `価し得る^i
◎
If url is "about:blank" or "about:srcdoc", return "Potentially Trustworthy".
</li>
	<li>
<p>
~RET `生成元は信用に価し得るか？$( %url の`生成元$url )
◎
Return the result of executing §3.2 Is origin potentially trustworthy? on url’s origin.
</p>

<p class="note">注記：
`blob^sc ／ `filesystem^sc
~URLの生成元は，それらを作成した文脈の生成元になる。
したがって，信用に価する生成元~内で作成された~blobは，それ自身 信用に価し得ることになる。
◎
Note: The origin of blob: and filesystem: URLs is the origin of the context in which they were created. Therefore, blobs created in a trustworthy origin will themselves be potentially trustworthy.
</p>
	</li>
</ol>

		</section>
	</section>
	<section id="threat-models-risks">
<h2 title="Threat models and risks ">4. 脅威~modelとその~risk</h2>

~INFORMATIVE

		<section id="threat-models">
<h3 title="Threat Models">4.1. 脅威~model</h3>

<p>
未認証の生成元に対する許可を是認することは、~network攻撃者の~~存在において，任意の生成元に対する許可を是認することに等価になる。
Internet においては、そのような~network攻撃者が~~実在するものと見做さなければナラナイ。
一般に，~network攻撃者は、受動的, 能動的の 2 つに分類される。
◎
Granting permissions to unauthenticated origins is, in the presence of a network attacker, equivalent to granting the permissions to any origin. The state of the Internet is such that we must indeed assume that a network attacker is present. Generally, network attackers fall into 2 classes: passive and active.
</p>

			<section id="threat-passive">
<h4 title="Passive Network Attacker">4.1.1. 受動的~network攻撃者</h4>

<p>
“受動的~network攻撃者” は、流通~flowを観測できるが，この仕様が懸念する層における流通を 改変する~~能を欠くか, 改変しないことにした者である。
◎
A "Passive Network Attacker" is a party who is able to observe traffic flows but who lacks the ability or chooses not to modify traffic at the layers which this specification is concerned with.
</p>

<p>
この方式による~networkの監視0は、
“通信している当の主体の同意なしに，彼らの意図をないがしろにする”
ものであり、
“他の行為者による監視
— 誰がどの程度それを善意と見なすかにかかわらず —
を許容している者は、ほとんどの無法な行為者に抗して防御できない”
ことを指す。
`RFC7258$r
したがって、この文書に定義される~algoは、単純に完全性のみならず，~app層における~dataの~privacyを供する仕組みも要求する。
◎
Surveillance of networks in this manner "subverts the intent of communicating parties without the agreement of these parties" and one "cannot defend against the most nefarious actors while allowing monitoring by other actors no matter how benevolent some might consider them to be." [RFC7258] Therefore, the algorithms defined in this document require mechanisms that provide for the privacy of data at the application layer, not simply integrity.
</p>



			</section>
			<section id="threat-active">
<h4 title="Active Network Attacker">4.1.2. 能動的~network攻撃者</h4>

<p>
“能動的~network攻撃者” は、 “受動的~network攻撃者” が有する能力に加え，~networkを通過している~dataを［
改変- ／ 阻止- ／ 再生-
］できる者である。
これらの能力は、多くの~levelで敵に可用になる
— 公共~無線~network内で［
提供している ／ 単純に関与している
］ような弱体化された機器から，金銭的利益の流通を操作していながら 保安や~privacyの脆弱性を間接的に導入しているような ISP （最近の例として、 `VERIZON$r や `COMCAST$r が挙げられる）まで、果ては［
個々の利用者／組織／団体／あらゆる人々
］でさえ標的にできるような，保安や~privacyを弱体化する意図を指図する主体までにわたる。
◎
An "Active Network Attacker" has all the capabilities of a "Passive Network Attacker" and is additionally able to modify, block or replay any data transiting the network. These capabilities are available to potential adversaries at many levels of capability, from compromised devices offering or simply participating in public wireless networks, to Internet Service Providers indirectly introducing security and privacy vulnerabilities while manipulating traffic for financial gain ([VERIZON] and [COMCAST] are recent examples), to parties with direct intent to compromise security or privacy who are able to target individual users, organizations or even entire populations.
</p>



			</section>
		</section>
		<section id="ancestors">
<h3 title="Ancestral Risk">4.2. 先祖による~risk</h3>

<p>
`環境~設定群~objは保安的~文脈を与えるか？$の~algoは、当の文脈が保安的になるかどうか決定する際に，その文脈のすべての先祖を巡回する。
なぜ、文書は `iframe$e 内に保安的に送達されたこと自体では，保安的と見なされないのか？
◎
The Is an environment settings object contextually secure? algorithm walks through all the ancestors of a particular context in order to determine whether or not the context itself is secure. Why wouldn’t we consider a securely-delivered document in an iframe to be secure, in and of itself?
</p>

<p>
短く答えるなら、その~modelでは濫用-が可能化されるからである。
Chrome による
`WEBCRYPTOAPI$r 実装による，~APIを保安的~文脈に~lockする早期の実験では、文脈の先祖を巡回していなかった。
そこでは、~APIを，自身が保安的に送達された資源に~lockすることで、保安的な用法は十分に確保されると見做していた。
しかしながらその結果は、~APIを非保安的~文脈に公開するような［
`iframe$e と `postMessage()^m
］に基づく~shimを築いた Netflix の様な実体であった。
その制約は、~APIへの非保安的~accessを，段差舗装より少しばかり遅くするものであったが、その種の~accessを防止するには，何ら効果がなかった。
◎
The short answer is that this model would enable abuse. Chrome’s implementation of [WEBCRYPTOAPI] was an early experiment in locking APIs to secure contexts, and it did not walk through a context’s ancestors. The assumption was that locking the API to a resouce which was itself delivered securely would be enough to ensure secure usage. The result, however, was that entities like Netflix built iframe- and postMessage()-based shims that exposed the API to non-secure contexts. The restriction was little more than a speed-bump, slowing down non-secure access to the API, but completely ineffective in preventing such access.
</p>

<p>
この文書における~algoは，非保安的~文脈を`保安的~文脈$から完全0には隔離しないが（<a href="#isolation">不完全な隔離</a>節を見よ）、先祖の検査は，そのような文脈に供されるべき［
認証, 機密性, 完全性
］を保証するような，相応に堅牢な保護を供する。
◎
While the algorithms in this document do not perfectly isolate non-secure contexts from secure contexts (as discussed in §5.1 Incomplete Isolation), the ancestor checks provide a fairly robust protection for the guarantees of authentication, confidentiality, and integrity that such contexts ought to provide.
</p>



		</section>
		<section id="threat-risks">
<h3 title="Risks associated with non-secure contexts">4.3. 非保安的~文脈に結付けられる~risk</h3>

<p>
利用者の保安や~privacyに独特の影響0を及ぼすような，ある種の~web~platform特能は、上述の脅威に抗して防御するため，`保安的~文脈$に限って可用にされるべきである。
非保安的~文脈にて可用な特能は、その能力を~network攻撃者に公開する~riskがある：
◎
Certain web platform features that have a distinct impact on a user’s security or privacy should be available for use only in secure contexts in order to defend against the threats above. Features available in non-secure contexts risk exposing these capabilities to network attackers:
</p>

<ol>

	<li>
敏感な~data（個人を特定する情報, 資格証, 対外支払い法, 等々）を読取る／改変する能
`CREDENTIAL-MANAGEMENT-1$r
は、敏感な~dataを取扱う~APIの例である。
◎
The ability to read and modify sensitive data (personally-identifying information, credentials, payment instruments, and so on). [CREDENTIAL-MANAGEMENT-1] is an example of an API that handles sensitive data.
</li>
	<li>
利用者の機器~上の~sensorからの入力を［
読取る／改変する
］能（特に ~camera, ~microphone, GPS が挙げられるが、そこまで危険に見えない加速度計の様な~sensorも，間違いなく含まれる）。
`GEOLOCATION-API$r, `MEDIACAPTURE-STREAMS$r
は、~sensor入力を利用する特能の歴史的な例である。
◎
The ability to read and modify input from sensors on a user’s device (camera, microphone, and GPS being particularly noteworthy, but certainly including less obviously dangerous sensors like the accelerometer). [GEOLOCATION-API] and [MEDIACAPTURE-STREAMS] are historical examples of features that use sensor input.
</li>
	<li>
利用者が~accessを有する他の機器についての情報に~accessする能。
格好の例として，
`DISCOVERY-API$r, `WEB-BLUETOOTH$r
が挙げられる。
◎
The ability to access information about other devices to which a user has access. [DISCOVERY-API] and [WEB-BLUETOOTH] are good examples.
</li>
	<li>
<p >
利用者が一時的または持続的に利用している識別子を追跡する能
— 次のものが含まれる：
</p>
<ul ><li>ある期間後に自身を設定し直す識別子（例： `sessionStorage$m ）
</li><li>利用者が手動で設定し直せる識別子（例：
`ENCRYPTED-MEDIA$r, ~cookie `RFC6265$r, `IndexedDB$r ）
</li><li>利用者が容易に設定し直せない~hardware特能を識別するもの
</li></ul>

◎
The ability to track users using temporary or persistent identifiers, including identifiers which reset themselves after some period of time (e.g. window.sessionStorage), identifiers the user can manually reset (e.g. [ENCRYPTED-MEDIA], Cookies [RFC6265], and [IndexedDB]), as well as identifying hardware features the user can’t easily reset.
</li>
	<li>
閲覧~sessionを超えて持続化するような，生成元に何らかの状態を導入する能。
特に， `SERVICE-WORKERS$r が挙げられる。
◎
The ability to introduce some state for an origin which persists across browsing sessions. [SERVICE-WORKERS] is a great example.
</li>
	<li>
~UAの~native~UIを，何らかの仕方で操作する能
— 利用者のそれらの文脈に関連する詳細に対する理解を［
除去する／遮る／操作する
］ような。
格好の例として， `FULLSCREEN$r が挙げられる。
◎
The ability to manipulate a user agent’s native UI in some way which removes, obscures, or manipulates details relevant to a user’s understanding of their context. [FULLSCREEN] is a good example.
</li>
	<li>
利用者に許可を要求するような何らかの機能性を導入する能。
◎
The ability to introduce some functionality for which user permission will be required.
</li>
</ol>


<p>
上述の~listは網羅的ではないが、仕様を書いたり実装するときに考慮すべき~riskの型についての感触を与えるであろう。
◎
This list is non-exhaustive, but should give you a feel for the types of risks we should consider when writing or implementing specifications.
</p>

<p class="note">注記：
特能~自身を`保安的~文脈$に制約することが~criticalである一方で、そのような情報を運ぶ便宜性（~network~accessの新たな仕組み, その他，~network~dataへの~accessを伴う汎用の関数など）も等しく敏感であることを，忘れるべきでない。
◎
Note: While restricting a feature itself to secure contexts is critical, we ought not forget that facilities that carry such information (such as new network access mechanisms, or other generic functions with access to network data) are equally sensitive.
</p>

		</section>
	</section>
	<section id="security-considerations">
<h2 title="Security Considerations">5. 保安~上の考慮点</h2>

		<section id="isolation">
<h3 title="Incomplete Isolation">5.1. 不完全な隔離</h3>

<p>
この文書における`保安的~文脈$の定義は、ある生成元~上の “保安的” ~viewを
同じ生成元~上の “非保安的” ~viewから完全には隔離しない。
`exfiltration^en 【外部への “裏口通信” 】 は、依然として，見え難い部分を次第に拡げていくような仕組み
— `localStorage$m や `sessionStorage$m の内容,
`storage$et ~event,
`BroadcastChannel$I,
その他など —
を介してアリになる。
◎
The secure context definition in this document does not completely isolate a "secure" view on an origin from a "non-secure" view on the same origin. Exfiltration will still be possible via increasingly esoteric mechanisms such as the contents of localStorage/sessionStorage, storage events, BroadcastChannel, and others.
</p>



		</section>
		<section id="localhost">
<h3 title="localhost">5.2. ~localhost</h3>

<p>
`RFC6761$r の節 6.3 では、
`localhost.^l や `.localhost.^l に類する名前の解決は特別であり、局所~解決器は，それらを特別に［
扱うべき／扱ってもヨイ
］ものと示唆している。
善悪は別として、解決器は，いくつかの状況下で この示唆を無視して，~localhostを解決するために~networkへ送信することが多い。
◎
Section 6.3 of [RFC6761] lays out the resolution of localhost. and names falling within .localhost. as special, and suggests that local resolvers SHOULD/MAY treat them specially. For better or worse, resolvers often ignore these suggestions, and will send localhost to the network for resolution in a number of circumstances.
</p>

<p>
そのような不確かさをふまえ，~UAは、［
`let-localhost-be-localhost$r による~localhost名前~解決 規則
］を固守する場合（それは、~localhostは，決して非~loopback~addressに解決されないことを確保する）, その場合に限り，~localhost名を信用に価し得る生成元と扱ってもヨイ。
◎
Given that uncertainty, user agents MAY treat localhost names as having potentially trustworthy origins if and only if they also adhere to the localhost name resolution rules spelled out in [let-localhost-be-localhost] (which boil down to ensuring that localhost never resolves to a non-loopback address).
</p>

		</section>
	</section>
	<section id="privacy-considerations">
<h2 title="Privacy Considerations">6. ~privacy上の考慮点</h2>

<p>
この文書における`保安的~文脈$の定義は、それ自身には，~privacyへの影響0はない。
しかしながら，それは、［［［［
完全性, 認証性, 機密性
］に関して特定の保証を確保するような文脈
］の中へ，自身を~lockする
］ような，［
関心を引く~privacy上の含意
］が~~実際にある，他の特能
］を可能化する。
◎
The secure context definition in this document does not in itself have any privacy impact. It does, however, enable other features which do have interesting privacy implications to lock themselves into contexts which ensures that specific guarantees can be made regarding integrity, authenticity, and confidentiality.
</p>

<p>
~privacyの観点からは、仕様の策定者には，［
自身が定義する特能に対し，保安的~文脈を要求する
］ことを考慮することが奨励される。
◎
From a privacy perspective, specification authors are encouraged to consider requiring secure contexts for the features they define.
</p>



	</section>
	<section id="implementation-considerations">
<h2 title="Implementation Considerations">7. 実装にあたっての考慮点</h2>



		<section id="packaged-applications">
<h3 title="Packaged Applications">7.1. ~package化~app</h3>

<p>
~package化された~appを~supportする~UAは、［
~UAにより認証-済みの内容を伴うような，特定の~URL~scheme
］を “保安的” と見なしてもヨイ。
例えば， FirefoxOS ~appの資源は、
`app^sc `~scheme$urlの~URLで指される。
同様に， Chrome の拡張／~appは、
`chrome-extension^sc ~schemeに住まう。
これらを信用-済みの生成元と見なすのが，適理なこともある。
◎
A user agent that support packaged applications MAY consider as "secure" specific URL schemes whose contents are authenticated by the user agent. For example, FirefoxOS application resources are referred to by a URL whose scheme component is app:. Likewise, Chrome’s extensions and apps live on chrome-extension: schemes. These could reasonably be considered trusted origins.
</p>



		</section>
		<section id="development-environments">
<h3 title="Development Environments">7.2. 開発~環境</h3>

<p>
~loopbackでない~host上で試験用~serverを走らす開発者を~supportするため、~UAは，特定の［
生成元の集合
］を
— それらに対する `生成元は信用に価し得るか？$が，通常は `価しない^i を返すとしても —
信用に価するものと，利用者が環境設定できるようにしてもヨイ。
◎
In order to support developers who run staging servers on non-loopback hosts, the user agent MAY allow users to configure specific sets of origins as trustworthy, even though §3.2 Is origin potentially trustworthy? would normally return "Not Trustworthy".
</p>



		</section>
		<section id="new">
<h3 title="Restricting New Features">7.3. 新たな特能の制約-法</h3>

~INFORMATIVE

<p>
新たな特能~用の仕様を書く策定者／編集者には、［
`保安的~文脈$に対する検査により，敏感な~APIを防護する
］ことが推奨される。
例えば、次の様に書く所から始めるのが良いであろう：
◎
When writing a specification for new features, we recommend that authors and editors guard sensitive APIs with checks against secure contexts. For example, something like the following might be a good approach:
</p>

<div class="example">
<ol>
	<li>
<p>
~IF［
`現在の設定群~obj$は `保安的~文脈$でない
］：
◎
If the current settings object is not a secure context, then:
</p>

		<ol>
			<li>
<p>
＜ここに何か適切なものを挿入する＞
— おそらく、次に挙げるものなど：
</p>

<ul ><li>`Promise^I を `SecurityError^E で却下する,
</li><li>~error用の~callbackを~callする,
</li><li>何かの許可~要請を否認する, 等々。
</li></ul>

◎
[insert something appropriate here: perhaps a Promise could be rejected with a SecurityError, an error callback could be called, a permission request denied, etc.].
</li>
		</ol>
	</li>
</ol>
</div>

<p>
別法として，策定者は、敏感な~APIを次のように [`SecureContext$] 拡張属性で防護して，`保安的~文脈$に限り公開されるよう確保することもできる：
◎
Authors could alternatively ensure that sensitive APIs are only exposed to secure contexts by guarding them with the [SecureContext] attribute.
</p>

<div class="example">

<pre class="idl">
[`SecureContext$]
interface SensitiveFeature {
  Promise&lt;double&gt; getTheSecretDouble();
};

// <span class="comment">あるいは：</span>

interface AnotherSensitiveFeature {
  [`SecureContext$] void doThatPowerfulThing();
};

</pre>

</div>

		</section>
		<section id="legacy">
<h3 title="Restricting Legacy Features">7.4. 旧来の特能の制約-法</h3>

~INFORMATIVE

<p>
上述の~listには、明白に，現在は非保安的~channel越しでも~webに可用な，既存の機能性も含まれている。
そのような旧来の機能性は、適度にアリな限り，早急に`保安的~文脈$を要求し始めるよう改変する `W3C-PROCESS$r
ことが推奨される
— そのような特能が：
◎
The list above clearly includes some existing functionality that is currently available to the web over non-secure channels. We recommend that such legacy functionality be modified to begin requiring a secure context as quickly as is reasonably possible [W3C-PROCESS].
</p>


<dl class="switch">
	<dt>広範に実装されていない場合：</dt>
	<dd>
即時に、`保安的~文脈$への制約を含むよう，仕様を`改変する$xことが推奨される。
◎
If such a feature is not widely implemented, we recommend that the specification be immediately modified to include a restriction to secure contexts.
</dd>

	<dt>広範に実装されているが，まだ広範には利用されていない場合：</dt>
	<dd>
早急に、<a href="#new">新たな特能の制約-法</a>に述べた検査を既存の実装に追加して，`保安的~文脈$に制約した上で、それに則って仕様も`改変する$xことが推奨される。
◎
If such a feature is widely implemented, but not yet in wide use, we recommend that it be quickly restricted to secure contexts by adding a check as described in §7.3 Restricting New Features to existing implementations, and modifying the specification accordingly.
</dd>

	<dt>広範に利用されている場合：</dt>
	<dd>
非推奨にすることが推奨される。
すなわち，当の仕様を，この文書に概説した制約に適合しないことを注記するように`改変する$xことに加えて、特能の適合的~versionを提供して，既存の利用者をその新たな~versionに移行してもらう計画が開発されるべきである。
◎
If such a feature is in wide use, we recommend that the existing functionality be deprecated; the specification should be modified to note that it does not conform to the restrictions outlined in this document, and a plan should be developed to both offer a conformant version of the feature and to migrate existing users into that new version.
</dd>
</dl>

			<section id="legacy-example">
<h4 title="Example: Geolocation">7.4.1. 例： Geolocation</h4>

<p>
`GEOLOCATION-API$r
は、そのような特能の格好の具体~例である。
それは、広範に実装され，多数の非保安的~siteで利用されている。
適度な移行過程は、次の様になるであろう：
◎
The [GEOLOCATION-API] is a good concrete example of such a feature; it is widely implemented and used on a large number of non-secure sites. A reasonable path forward might look like this:
</p>

<ol>
	<li>
<p>
`保安的~文脈$に対する検査を含めるように，仕様~内の［
`getCurrentPosition()$m ／ `watchPosition()$m
］~algoを実行する前の箇所に次を挿入するように`改変する$x：
◎
Modify the specification to include checks against secure context before executing the algorithms for getCurrentPosition() and watchPosition().
</p>

<div class="p">
		<ol>
			<li>
<p>
~UAは次を走らすべきである：
</p>
				<ol>
					<li>
<p>
~IF［
`現在の設定群~obj$は`保安的~文脈$でない
］：
</p>
						<ol>
							<li>
次を引数に，渡された %errorCallback を呼出す
⇒
次のようにされた新たな `PositionError^I ~obj
⇒
`code^m 属性 ~SET `PERMISSION_DENIED^m
</li>
							<li>
~RET
</li>
						</ol>
					</li>
				</ol>
			</li>
		</ol>

◎
If the current settings object is not a secure context, then the algorithm should be aborted, and the errorCallback invoked with a code of PERMISSION_DENIED.
</div>
	</li>
	<li>
~UAは、［
非保安的~文脈に対しては、~APIを特定の日付にて不能化すること
］の明白な意向を公告した上で、それに則って開発者にも（例えば ~console~messageを介して）警告するべきである。
◎
The user agent should announce clear intentions to disable the API for non-secure contexts on a specific date, and warn developers accordingly (via console messages, for example).
</li>
	<li>

<p>
~UAは、その日が来る前に，非推奨~についての期日を公告して、［
~site作者に，~codeが道連れに機能停止する前に改変する必要を認識してもらう
］こと, および［
さしあたり，利用者を保護する
］ことを確保するべきである。
そのような計画は、次のうちいくつかを含むであろう：
◎
Leading up to the flag day, the user agent should announce a deprecation schedule to ensure both that site authors recognize the need to modify their code before it simply stops working altogether, and to protect users in the meantime. Such a plan might include any or all of:
</p>

		<ul>
			<li>
非保安的~生成元を是認するような持続的~許可を許容しない。
◎
Disallowing persistent permission grants to non-secure origins
</li>
			<li>
非保安的~生成元に対しては、~APIの精度を粗くする（おそらく，地番~levelでなく府県~levelの~dataを一貫して返すようにするなど）。
◎
Coarsening the accuracy of the API for non-secure origins (perhaps consistently returning city-level data rather than high-accuracy data)
</li>
			<li>
利用者や~site作者に~riskを伝えるような，~UIの改変。
◎
UI modifications to inform users and site authors of the risk
</li>
		</ul>
	</li>
</ol>

			</section>
		</section>
	</section>
	<section id="acknowledgements">
<h2 title="Acknowledgements">8. 謝辞</h2>

<p>
この文書は、 Chrome Security ~teamによる
`POWERFUL-NEW-FEATURES$r に対する
仕事に大きく基づいている。
特に従事されていた
`Chris Palmer, Ryan Sleevi, David Dorwin^en
各氏に。
とりわけ参考になる~feedbackを寄せられた
`Anne van Kesteren, Jonathan Watt, Boris Zbarsky, Henri Sivonen^en
各氏にも。
◎
This document is largely based on the Chrome Security team’s work on [POWERFUL-NEW-FEATURES]. Chris Palmer, Ryan Sleevi, and David Dorwin have been particularly engaged. Anne van Kesteren, Jonathan Watt, Boris Zbarsky, and Henri Sivonen have also provided very helpful feedback.
</p>
	</section>

</main></div>
